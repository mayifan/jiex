# 结项单生成工具

这是一个用于生成项目结项单的工具，可以从 Excel 文件中读取数据并生成 Word 文档。

## 功能特性

- 上传 Excel 文件（支持 .xlsx 和 .xls 格式）
- 自动从 Excel 中提取数据
- **参与者管理**：
  - ✅ 手动新增参与者（姓名 + 工号）
  - ✅ 删除不需要的参与者
  - ✅ 选择第一参与者（默认马一帆，可更换）
- **智能金额分配系统**：根据项目数量自动计算总金额，手动分配给参与者
- 使用模板生成结项单 Word 文档
- 根据金额分配自动分配项目参与者
- 批量处理并打包为 ZIP 文件下载

## 参与者配置

### 默认参与者列表
- **马一帆 (SFD17221)** - 默认第一参与者
- **刘纪甲 (SDF21054)**
- **丁少康 (SFD16940)**
- **王鹏 (SFD21724)**
- **盛泉铭 (SFD22678)**
- **刘仲 (SFD16963)**

### 参与者管理
- **新增参与者**：在金额分配页面可以添加新的参与者
- **删除参与者**：点击参与者标签的关闭按钮即可删除
- **选择第一参与者**：可以从所有参与者中选择一人作为第一参与者（固定650元）

## 金额分配规则

- **每个项目固定 850 元**
  - 马一帆（必选，第1个参与者）：650 元（固定）
  - 其他2个参与者：共 200 元（每人至少 100 元）

- **分配说明**：
  - 总需分配金额 = 项目数量 × 200 元
  - 金额以**百元为单位**输入（例如输入 2 表示 200 元）
  - 所有参与者的金额总和必须等于总需分配金额
  - 系统会根据分配的金额自动将参与者分配到各个项目
  - 每个参与者在项目中出现的次数与其分配的金额成正比

## 本地开发

### 安装依赖
```bash
npm install
```

### 启动开发服务器
```bash
npm run dev
```

### 构建生产版本
```bash
npm run build
```

## Docker 部署

### 使用 Docker Compose（推荐）

```bash
# 构建并启动
docker-compose up -d

# 停止服务
docker-compose down

# 查看日志
docker-compose logs -f
```

访问地址：http://localhost:8080

### 使用 Docker 命令

```bash
# 构建镜像
docker build -t jiex-app .

# 运行容器
docker run -d -p 8080:80 --name jiex-app jiex-app

# 停止容器
docker stop jiex-app

# 删除容器
docker rm jiex-app
```

## 使用说明

### 步骤1：上传文件
1. 点击上传区域或拖拽 Excel 文件到上传区
2. 可以上传多个 Excel 文件
3. 点击"下一步：分配金额"按钮

### 步骤2：分配金额

#### 2.1 参与者管理（可选）
- **新增参与者**：输入姓名和工号，点击"添加参与者"
- **删除参与者**：点击参与者标签右侧的 ✕ 按钮
- **选择第一参与者**：从下拉框中选择谁作为第一参与者（默认马一帆）

#### 2.2 金额分配
1. 系统会自动统计项目数量并计算总需分配金额
   - 例如：5个项目 → 需分配 1000 元（10 个百元单位）
2. 为每个参与者（除第一参与者外）输入分配的金额（以百元为单位）
   - 例如：刘纪甲输入 4（即 400 元），丁少康输入 3（即 300 元）
3. 确保所有参与者的金额总和等于总需分配金额
   - 系统会实时显示已分配金额和剩余金额
   - 只有当剩余金额为 0 且至少2个参与者有金额时才能继续
4. 点击"确认分配并生成文档"按钮

### 步骤3：下载文档
1. 系统自动生成所有结项单文档
2. 自动下载打包的 ZIP 文件
3. 解压 ZIP 文件即可看到生成的 Word 文档

## 金额分配示例

假设上传了 **5 个项目**：

### 计算分配额度
- **每个项目**：850 元（马一帆 650 元 + 其他 200 元）
- **总需分配金额**：5 × 200 = 1000 元（10 个百元单位）

### 分配方案示例
- 刘纪甲：**4** 百元（400 元）
- 丁少康：**3** 百元（300 元）
- 王鹏：**3** 百元（300 元）
- **总计**：**10** 百元（1000 元）✓

### 分配结果
系统会自动将这些参与者分配到 5 个项目中：
- 刘纪甲出现在 4 个项目中（每次 100 元）
- 丁少康出现在 3 个项目中（每次 100 元）
- 王鹏出现在 3 个项目中（每次 100 元）
- 马一帆出现在所有 5 个项目中（每次 650 元）

每个项目的参与者随机组合，但总体比例与分配金额一致。

## 技术栈

- Vue 3
- Element Plus
- Vite
- XLSX（Excel 处理）
- Docxtemplater（Word 模板）
- JSZip（压缩文件）

## 许可证

MIT
